<!doctype html><html lang=en><head><title>Quantum Fisher Information with automatic differentiation</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.cc971cdbc2ebfe7afcea9dcb21c92f48a71e3d942fc0029183f03684cb4b4137.css integrity="sha256-zJcc28Lr/nr86p3LIckvSKcePZQvwAKRg/A2hMtLQTc="><link rel=icon type=image/png href=/images/site/paper-plane-regular_inverted_hu_9166616b26135953.png><meta property="og:title" content="Orjan Ameye"><meta property="og:type" content="website"><meta property="og:description" content><meta property="og:image" content="/"><meta property="og:url" content="https://oameye.github.io/"><meta name=description content="Quantum Fisher Information with automatic differentiation"><script async src="https://www.googletagmanager.com/gtag/js?id=G-H4LBG7NDFZ"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H4LBG7NDFZ")}</script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/paper-plane-regular_hu_376c49fc055415d7.png id=logo alt=Logo>
Orjan Ameye</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Home</a></li><li class=nav-item><a class=nav-link href=/#about>About</a></li><li class=nav-item><a class=nav-link href=/#featured-posts>Featured Posts</a></li><li class=nav-item><a class=nav-link href=/#experiences>Experiences</a></li><li class=nav-item><a class=nav-link href=/#education>Education</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false>More</a><div class=dropdown-menu aria-labelledby=navbarDropdown><a class=dropdown-item href=/#projects>Projects</a>
<a class=dropdown-item href=/#publications>Publications</a>
<a class=dropdown-item href=/#recent-posts>Recent Posts</a></div></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class=nav-item><a class=nav-link id=note-link href=/notes>Notes</a></li></ul></div></div><img src=/images/site/paper-plane-regular_hu_376c49fc055415d7.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/paper-plane-regular_inverted_hu_9166616b26135953.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><a class=list-link href=/posts/automatic_differentiation/ title="Automatic differentiation">Automatic differentiation</a></li><li><a class=list-link href=/posts/bloch_oscillations/ title="Bloch oscillations">Bloch oscillations</a></li><li><a class=list-link href=/posts/eigenfunctions/ title="Ground state eigenfunctions">Ground state eigenfunctions</a></li><li><a class=list-link href=/posts/parametron/ title="Parametric resonator">Parametric resonator</a></li><li><a class="active list-link" href=/posts/quantum_fisher_information/ title="Quantum Fisher Information">Quantum Fisher Information</a></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/posts/quantum_fisher_information/preview.svg)></div><div class=page-content><div style=margin-bottom:80px></div><div class=title><h1>Quantum Fisher Information with automatic differentiation</h1></div><div class="author-profile ms-auto align-self-lg-center"><p class=text-muted>Sunday, July 13, 2025 | 3 minutes</p></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/julia/ class="btn btn-sm btn-info">Julia</a></li><li class=rounded><a href=/tags/tutorial/ class="btn btn-sm btn-info">Tutorial</a></li><li class=rounded><a href=/tags/automatic-differentiation/ class="btn btn-sm btn-info">Automatic Differentiation</a></li></ul></div><div class=post-content id=post-content><p>This notebook demonstrates the computation of Quantum Fisher Information (QFI) for a driven-dissipative Kerr Parametric Oscillator (KPO) using automatic differentiation. The QFI quantifies the ultimate precision limit for parameter estimation in quantum systems.</p><p>We import the necessary packages for quantum simulations and automatic differentiation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>using</span> QuantumToolbox      <span style=color:#75715e># Quantum optics simulations</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> DifferentiationInterface  <span style=color:#75715e># Unified automatic differentiation interface</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> SciMLSensitivity   <span style=color:#75715e># Allows for ODE sensitivity analysis</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> FiniteDiff         <span style=color:#75715e># Finite difference methods</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> LinearAlgebra      <span style=color:#75715e># Linear algebra operations</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> CairoMakie              <span style=color:#75715e># Plotting</span>
</span></span><span style=display:flex><span>CairoMakie<span style=color:#f92672>.</span>activate!(type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;svg&#34;</span>)
</span></span></code></pre></div><h2 id=system-parameters-and-hamiltonian>System Parameters and Hamiltonian</h2><p>The KPO system is governed by the Hamiltonian:
$$H = -p_1 a^\dagger a + K (a^\dagger)^2 a^2 - G (a^\dagger a^\dagger + a a)$$</p><p>where:</p><ul><li>$p_1$ is the parameter we want to estimate (detuning)</li><li>$K$ is the Kerr nonlinearity</li><li>$G$ is the parametric drive strength</li><li>$\gamma$ is the decay rate</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>function</span> final_state(p, t)
</span></span><span style=display:flex><span>    G, K, γ <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.002</span>, <span style=color:#ae81ff>0.001</span>, <span style=color:#ae81ff>0.01</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    N <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span> <span style=color:#75715e># cutoff of the Hilbert space dimension</span>
</span></span><span style=display:flex><span>    a <span style=color:#f92672>=</span> destroy(N) <span style=color:#75715e># annihilation operator</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    coef(p,t) <span style=color:#f92672>=</span> <span style=color:#f92672>-</span> p[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    H <span style=color:#f92672>=</span> QobjEvo(a<span style=color:#f92672>&#39;</span> <span style=color:#f92672>*</span> a , coef) <span style=color:#f92672>+</span> K <span style=color:#f92672>*</span> a<span style=color:#f92672>&#39;</span> <span style=color:#f92672>*</span> a<span style=color:#f92672>&#39;</span> <span style=color:#f92672>*</span> a <span style=color:#f92672>*</span> a <span style=color:#f92672>-</span> G <span style=color:#f92672>*</span> (a<span style=color:#f92672>&#39;</span> <span style=color:#f92672>*</span> a<span style=color:#f92672>&#39;</span> <span style=color:#f92672>+</span> a <span style=color:#f92672>*</span> a)
</span></span><span style=display:flex><span>    c_ops <span style=color:#f92672>=</span> [sqrt(γ)<span style=color:#f92672>*</span>a]
</span></span><span style=display:flex><span>    ψ0 <span style=color:#f92672>=</span> fock(N, <span style=color:#ae81ff>0</span>) <span style=color:#75715e># initial state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    tlist <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>    sol <span style=color:#f92672>=</span> mesolve(H, ψ0, tlist, c_ops; params <span style=color:#f92672>=</span> p, progress_bar <span style=color:#f92672>=</span> <span style=color:#66d9ef>Val</span>(false), saveat <span style=color:#f92672>=</span> [t])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sol<span style=color:#f92672>.</span>states[<span style=color:#66d9ef>end</span>]<span style=color:#f92672>.</span>data
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><pre tabindex=0><code>final_state (generic function with 1 method)
</code></pre><h2 id=quantum-fisher-information-calculation>Quantum Fisher Information Calculation</h2><p>The QFI is computed using the symmetric logarithmic derivative (SLD). For a density matrix $\rho(\theta)$ parametrized by $\theta$:</p><p>$$F_Q = \text{Tr}[\partial_\theta \rho \cdot L]$$</p><p>where $L$ is the SLD satisfying: $\partial_\theta \rho = \frac{1}{2}(\rho L + L \rho)$</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>function</span> compute_fisher_information(ρ, dρ)
</span></span><span style=display:flex><span>    reg <span style=color:#f92672>=</span> <span style=color:#ae81ff>1e-12</span> <span style=color:#f92672>*</span> I <span style=color:#75715e># Add small regularization to avoid numerical issues with zero eigenvalues</span>
</span></span><span style=display:flex><span>    ρ_reg <span style=color:#f92672>=</span> ρ <span style=color:#f92672>+</span> reg
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    L <span style=color:#f92672>=</span> sylvester(ρ_reg, ρ_reg, <span style=color:#f92672>-</span><span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>dρ) <span style=color:#75715e># This is a Sylvester equation: ρL + Lρ = 2*dρ</span>
</span></span><span style=display:flex><span>    F <span style=color:#f92672>=</span> real(tr(dρ <span style=color:#f92672>*</span> L)) <span style=color:#75715e># Fisher information F = Tr(dρ * L)</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> F
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span></code></pre></div><pre tabindex=0><code>compute_fisher_information (generic function with 1 method)
</code></pre><h2 id=automatic-differentiation-setup>Automatic Differentiation Setup</h2><p>We use finite differences through DifferentiationInterface.jl to compute the derivative of the quantum state with respect to the parameter. This is a key step that enables efficient QFI computation without manual derivative calculations.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span>final_state([<span style=color:#ae81ff>0</span>], <span style=color:#ae81ff>100</span>) <span style=color:#75715e># Test the system</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>state(p) <span style=color:#f92672>=</span> final_state(p, <span style=color:#ae81ff>2000</span>) <span style=color:#75715e># Define state function for automatic differentiation</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ρ, dρ <span style=color:#f92672>=</span> DifferentiationInterface<span style=color:#f92672>.</span>value_and_jacobian(state, AutoFiniteDiff(), [<span style=color:#ae81ff>0.0</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dρ <span style=color:#f92672>=</span> QuantumToolbox<span style=color:#f92672>.</span>vec2mat(vec(dρ)) <span style=color:#75715e># Reshape the derivative back to matrix form</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>qfi_final <span style=color:#f92672>=</span> compute_fisher_information(ρ, dρ) <span style=color:#75715e># Compute QFI at final time</span>
</span></span><span style=display:flex><span>println(<span style=color:#e6db74>&#34;QFI at final time: &#34;</span>, qfi_final)
</span></span></code></pre></div><pre tabindex=0><code>QFI at final time: 19795.821946511165
</code></pre><h2 id=time-evolution-of-quantum-fisher-information>Time Evolution of Quantum Fisher Information</h2><p>Now we compute how the QFI evolves over time to understand the optimal measurement time for parameter estimation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span>ts <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2000</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>QFI_t <span style=color:#f92672>=</span> map(ts) <span style=color:#66d9ef>do</span> t
</span></span><span style=display:flex><span>    state(p) <span style=color:#f92672>=</span> final_state(p, t)
</span></span><span style=display:flex><span>    ρ, dρ <span style=color:#f92672>=</span> DifferentiationInterface<span style=color:#f92672>.</span>value_and_jacobian(state, AutoFiniteDiff(), [<span style=color:#ae81ff>0.0</span>])
</span></span><span style=display:flex><span>    dρ <span style=color:#f92672>=</span> QuantumToolbox<span style=color:#f92672>.</span>vec2mat(vec(dρ))
</span></span><span style=display:flex><span>    compute_fisher_information(ρ, dρ)
</span></span><span style=display:flex><span><span style=color:#66d9ef>end</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>println(<span style=color:#e6db74>&#34;QFI computed for &#34;</span>, length(ts), <span style=color:#e6db74>&#34; time points&#34;</span>)
</span></span></code></pre></div><pre tabindex=0><code>QFI computed for 100 time points
</code></pre><h2 id=visualization>Visualization</h2><p>Plot the time evolution of the Quantum Fisher Information:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span>fig <span style=color:#f92672>=</span> Figure()
</span></span><span style=display:flex><span>ax <span style=color:#f92672>=</span> Axis(
</span></span><span style=display:flex><span> fig[<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>],
</span></span><span style=display:flex><span> xlabel <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Time&#34;</span>,
</span></span><span style=display:flex><span> ylabel <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Quantum Fisher Information&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>lines!(ax, ts, QFI_t)
</span></span><span style=display:flex><span>fig
</span></span></code></pre></div><p><img src=/posts/quantum_fisher_information/index-23.svg alt></p><h2 id=version-information>Version Information</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>using</span> InteractiveUtils
</span></span><span style=display:flex><span>InteractiveUtils<span style=color:#f92672>.</span>versioninfo()
</span></span></code></pre></div><pre tabindex=0><code>Julia Version 1.10.10
Commit 95f30e51f41 (2025-06-27 09:51 UTC)
Build Info:
  Official https://julialang.org/ release
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: 12 × AMD Ryzen 5 5600X 6-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-15.0.7 (ORCJIT, znver3)
Threads: 10 default, 0 interactive, 5 GC (on 12 virtual cores)
Environment:
  JULIA_EDITOR = code
  JULIA_VSCODE_REPL = 1
  JULIA_NUM_THREADS = 10
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-julia data-lang=julia><span style=display:flex><span><span style=color:#66d9ef>using</span> Pkg
</span></span><span style=display:flex><span>Pkg<span style=color:#f92672>.</span>status()
</span></span></code></pre></div><pre tabindex=0><code>Status `/var/home/oameye/Documents/website/content/posts/Quantum_Fisher_Information/Project.toml`
⌃ [13f3f980] CairoMakie v0.13.10
  [a0c0ee7d] DifferentiationInterface v0.7.2
  [6a86dc24] FiniteDiff v2.27.0
  [98b081ad] Literate v2.20.1
  [6c2fb7c5] QuantumToolbox v0.32.1
  [1ed8b502] SciMLSensitivity v7.87.0
  [37e2e46d] LinearAlgebra
Info Packages marked with ⌃ have new versions available and may be upgradable.
</code></pre><hr><p><em>This page was generated using <a href=https://github.com/fredrikekre/Literate.jl target=_blank rel=noopener>Literate.jl</a>.</em></p></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/oameye/hugo-toha/edit/main/content/posts/Quantum_Fisher_Information/index.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/parametron/ title="From harmonic oscillator to the parametron" class="btn filled-button"><div><i class="fas fa-chevron-circle-left"></i> Prev</div><div class=next-prev-text>From harmonic oscillator to the parametron</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#system-parameters-and-hamiltonian>System Parameters and Hamiltonian</a></li><li><a href=#quantum-fisher-information-calculation>Quantum Fisher Information Calculation</a></li><li><a href=#automatic-differentiation-setup>Automatic Differentiation Setup</a></li><li><a href=#time-evolution-of-quantum-fisher-information>Time Evolution of Quantum Fisher Information</a></li><li><a href=#visualization>Visualization</a></li><li><a href=#version-information>Version Information</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"></div></div></footer><script src=/application.d572847081d6f49d4af3880010a02bfcf047f2ab00c81d60f3843048d1e3ea4a.js integrity="sha256-1XKEcIHW9J1K84gAEKAr/PBH8qsAyB1g84QwSNHj6ko=" defer></script></body></html>